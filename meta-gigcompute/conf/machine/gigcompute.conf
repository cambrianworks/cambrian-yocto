#@TYPE: Machine
#@NAME: GigCompute with Jetson Orin Industrial 64GB (P3701-0008)
#@DESCRIPTION: GigCompute with Jetson Orin Industrial 64GB module in P3737 carrier

TEGRA_BOARDSKU ?= "0008"
TEGRA_BUPGEN_SPECS ?= "fab=500;boardsku=0008;boardrev=;chipsku=00:00:00:90;bup_type=bl \
                       fab=500;boardsku=0008;boardrev=;bup_type=kernel"
KERNEL_DEVICETREE ?= "tegra234-p3737-0000+p3701-0008-nv.dtb"
EMMC_SIZE ?= "63652757504"
ROOTFSPART_SIZE_DEFAULT ?= "59055800320"
EMMC_BCT ?= "tegra234-p3701-0008-sdram-l4t.dts"
PARTITION_LAYOUT_TEMPLATE_DEFAULT ?= "flash_t234_qspi_sdmmc_industrial.xml"
TEGRA_AUDIO_DEVICE ?= "tegra-ape"

# Needed to disable 10g PHY on built-in ethernet
ODMDATA = "gbe-uphy-config-0,hsstp-lane-map-3,hsio-uphy-config-16,nvhs-uphy-config-0"

TEGRA_FLASHVAR_PINMUX_CONFIG = "tegra234-gigrouter-mb1-bct-pinmux-p3701-0000-a04.dtsi"
TEGRA_FLASHVAR_BPFDTB_FILE = "tegra234-bpmp-3701-0008-3737-0000.dtb"
TEGRA_FLASHVAR_BPF_FILE = "bpmp_t234-TE992M-A1_prod.bin"
TEGRA_FLASHVAR_CHIP_SKU ?= "00:00:00:90"
TEGRA_FLASHVAR_MB2BCT_CFG = "tegra234-mb2-bct-misc-p3701-0008.dts"
TEGRA_FLASHVAR_MISC_CONFIG = "tegra234-mb1-bct-misc-p3701-0008-flash.dts"
TEGRA_FLASHVAR_PMIC_CONFIG = "tegra234-mb1-bct-pmic-p3701-0000.dts"
TEGRA_FLASHVAR_WB0SDRAM_BCT = "tegra234-p3701-0008-wb0sdram-l4t.dts"

# N.b., this is the stock DTB for Orin. However, prior to compilation
# meta-gig/recipes-kernel/nvidia-kernel-oot/nvidia-kernel-oot_%.bbappend
# applies platform-specific patches to enable additional hardware.
DTBFILE = "tegra234-p3737-0000+p3701-0008-nv.dtb"
KERNEL_DEVICETREE = "${DTBFILE}"

# Write an extlinux.conf to /boot/extlinux which allows for
# providing arguments to the kernel at startup. For very early
# stage debugging (e.g., before device probe) add:
# earlycon=uart8250,mmio32,0xc280000
UBOOT_EXTLINUX = "1"
UBOOT_EXTLINUX_KERNEL_ARGS = "root=mmcblk0p1 rw rootwait rootfstype=ext4 mminit_loglevel=4 console=TCU0,115200 \
console=ttyAMA0,115200 console=tty0 firmware_class.path=/etc/firmware fbcon=map:0 net.ifnames=0 nospectre_bhb"

MACHINE_EXTRA_RRECOMMENDS:append = " kernel-modules"

MACHINEOVERRIDES =. "gig:"

require conf/machine/include/agx-orin.inc
